---
# Copyright 2018, OpenNext SAS
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Kapacitor Vars
kapacitor_port: 9092
kapacitor_data_dir: /var/lib/kapacitor
kapacitor_logs_dir: /var/log/kapacitor
kapacitor_logging_file: "{{ kapacitor_logs_dir }}/kapacitor.log"
kapacitor_tick_script_dir: files/kapacitor/tick/scripts
kapacitor_tick_template_dir: files/kapacitor/tick/templates
kapacitor_tick_var_dir: files/kapacitor/tick/vars
kapacitor_tick_handler_dir: templates/kapacitor/handlers

kapacitor_container_bind_mounts:
  - bind_dir_path: "{{ kapacitor_data_dir }}"
    mount_path: "/openstack/{{ inventory_hostname }}"

kapacitor_influx:
  - name: "{{ ansible_hostname }}"
    enabled: true
    default: true
#   urls: ["{% for host in groups['influxdb'] %}http://{{ hostvars[host]['ansible_host'] }}:{{ influxdb_port }}{% if not loop.last %}, {% endif %}{% endfor %}"]
    urls: ["http://localhost:{{ influxdb_port }}"]
    username: ""
    password: ""
    ssl-ca: ""
    ssl-cert: ""
    ssl-key: ""
    insecure-skip-verify: false
    subscription-mode: server
    timeout: "0s"
    disable-subscriptions: false
    subscription-protocol: "http"
    kapacitor-hostname: "{{ ansible_hostname }}"
    http-port: 0
    udp-bind: ""
    udp-buffer: 1000
    udp-read-buffer: 0
    startup-timeout: "5m0s"
    subscriptions-sync-interval: "1m0s"
    subscription-mode: "cluster"
  
kapacitor_slack_enabled: true
kapacitor_slack_default: true
kapacitor_slack_global: true
kapacitor_slack_channel: "{{ slack_alerts_channel }}"
kapacitor_slack_url: "{{ slack_webhooks_url }}"
kapacitor_slack_username: kapacitor
kapacitor_slack_state_changes_only: true

# Configure global deadman
kapacitor_deadman_global: true
kapacitor_deadman_interval: "2m"
kapacitor_deadman_threshold: 1.0
